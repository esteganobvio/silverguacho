---
modules:
  - type: files
    files:
      - source: system
        destination: / # copies files/system/* (* means everything inside it) into your image's root folder /

  - type: dnf
    repos:
      files:
        # Docker repo
        - https://download.docker.com/linux/fedora/docker-ce.repo
        # Ghostty
        - https://copr.fedorainfracloud.org/coprs/scottames/ghostty/repo/fedora-%OS_VERSION%/scottames-ghostty-fedora-%OS_VERSION%.repo
        # Wezterm
        - https://copr.fedorainfracloud.org/coprs/wezfurlong/wezterm-nightly/repo/fedora-%OS_VERSION%/wezfurlong-wezterm-nightly-fedora-%OS_VERSION%.repo
        # Nerd fonts fallback
        - https://copr.fedorainfracloud.org/coprs/che/nerd-fonts/repo/fedora-%OS_VERSION%/che-nerd-fonts-fedora-%OS_VERSION%.repo
        # Brave browser
        - https://brave-browser-rpm-release.s3.brave.com/brave-browser.repo
        # Tailscale
        - https://pkgs.tailscale.com/stable/fedora/tailscale.repo
      keys:
        - https://brave-browser-rpm-release.s3.brave.com/brave-core.asc
    install:
      skip-unavailable: true
      install-weak-deps: true
      packages:
        # themes and fonts
        - jetbrains-mono-fonts-all
        - nerd-fonts
        - rsms-inter-fonts
        - rsms-inter-vf-fonts
        - yaru-theme
        # system tools
        - bootc
        - borgbackup
        - brave-browser
        - keepassxc
        - ddcutil
        - intel-undervolt
        - btop
        - gcc
        - git-credential-libsecret
        - lm_sensors
        - make
        - usbmuxd
        - util-linux
        - openssh-askpass
        - inotify-tools
        - tuned
        - tuned-ppd
        - fd-find
        - ripgrep
        - zoxide
        - openrgb-udev-rules
        # terminals and tools
        - ghostty
        - kitty
        - wezterm
        - fastfetch
        - neovim
        - zsh
        # graphical tools
        - mpv
        - playerctl
        - syncthing
        - wl-clipboard
        - gnome-tweaks
        - gnome-shell-extension-pop-shell
        - gnome-shell-extension-pop-shell-shortcut-overrides
        - gnome-shell-extension-appindicator
        - gnome-shell-extension-blur-my-shell
        - gnome-shell-extension-caffeine
        - gnome-shell-extension-dash-to-dock
        - gnome-shell-extension-gsconnect
        - gnome-shell-extension-gpaste
        - gpaste
        - nautilus-gsconnect
        - simple-scan
        - zenity
        # networking
        - NetworkManager-openconnect
        - NetworkManager-openconnect-gnome
        - NetworkManager-openvpn
        - NetworkManager-openvpn-gnome
        - bluez
        - bluez-tools
        - firewall-config
        - iwd
        - wireguard-tools
        # Tailscale
        - tailscale
        # waydroid
        - waydroid
        # Docker
        - docker-ce
        - docker-ce-cli
        - containerd.io
        - docker-buildx-plugin
        - docker-compose-plugin
        # rocm
        - rocminfo
        - rocm-hip
        # steam
        - steam
        - steam-devices
        - gamescope
    optfix:
      - brave.com
    remove:
      packages:
        - firefox
        - firefox-langpacks # also remove firefox dependency (not required for all packages, this is a special case)

  - type: script
    snippets:
      - "ln -sf /usr/lib/opt/brave.com/brave/brave-browser /usr/bin/brave-browser-stable"

  - type: default-flatpaks
    configurations:
      - notify: false
        scope: system
        # If no repo information is specified, Flathub will be used by default
        install:
          - org.gnome.Papers
          - com.mattjakeman.ExtensionManager
          - com.obsproject.Studio
          - com.obsproject.Studio.Plugin.DroidCam
          - com.protonvpn.www
          - io.github.input_leap.input-leap
          - it.mijorus.gearlever
          - org.gnome.Calendar
          - org.gnome.Firmware
          - org.gnome.Loupe
          - org.gnome.Snapshot
          - org.gnome.Weather
          - org.gnome.World.PikaBackup
          - org.gnome.seahorse.Application
          - org.localsend.localsend_app
        remove:
          - org.gnome.eog

  - type: brew
    brew-analytics: true

  - type: signing # this sets up the proper policy & signing files for signed images to work fully

